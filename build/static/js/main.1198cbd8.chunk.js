(this["webpackJsonpBasilisk-crowdloan-ui"]=this["webpackJsonpBasilisk-crowdloan-ui"]||[]).push([[0],{280:function(a,n,e){},281:function(a,n,e){},292:function(a,n){},296:function(a,n){},297:function(a,n){},321:function(a,n,e){},322:function(a,n,e){},435:function(a,n,e){"use strict";e.r(n);var t,c=e(14),i=e.n(c),o=e(240),r=e.n(o),l=(e(280),e(281),e(468)),d=e(470),s=e(460),u={indexerUrl:"https://ksm-arch.hydration.cloud/",nodeUrl:"wss://ksm-arch.hydration.cloud:1144",dappName:"Basilisk Crowdloan",ownParachainId:function(){var a=new URL(document.location).searchParams;return console.log("ownParachainId",a.get("ownParachainId")),a.get("ownParachainId")}()||"2000-Gq2No2gcF6s4DLfzzuB53G5opWCoCtK9tZeVGRGcmkSDGoK",ownParaId:"2000",blockTime:6e3,ownCrowdloanBlockNum:8220581,targetAuctionId:4,ksmOpportunityCost:"0.1375",ksmPrecision:12,ksmToUsd:"205.20",hdxToUsd:"0.0859",incentives:{precision:50,hdx:{decimals:12,scale:{leadPercentageDiff:{min:0,max:.1},rewardMultiplier:{min:.3,max:.05}}},bsx:{decimals:12,allocated:"15000000000000000000000",scale:{rewardMultiplier:{min:1,max:0,none:0}}}},historicalAuctionData:{1:{blockNum:7924237,closingStart:7951237,closingEnd:8023773},2:{blockNum:8024552,closingStart:8051552,closingEnd:8123989},3:{blockNum:8124516,closingStart:8151516,closingEnd:8223516},4:{blockNum:8224581,closingStart:8251581,closingEnd:8323581}}},b=e(15),g=new l.a({uri:u.indexerUrl,cache:new d.a,defaultOptions:{watchQuery:{fetchPolicy:"network-only"},query:{fetchPolicy:"network-only"}}}),j=function(a){var n=a.children;return Object(b.jsx)(s.a,{client:g,children:n})},h=e(1),m=e(26),v=e(163);!function(a){a.LoadChronicle="LOAD_CHRONICLE",a.SetChronicle="SET_CHRONICLE",a.LoadOwnData="LOAD_OWN_DATA",a.SetOwnData="SET_OWN_DATA",a.LoadSiblingData="LOAD_SIBLING_DATA",a.SetSiblingData="SET_SIBLING_DATA",a.ConnectAccount="CONNECT_ACCOUNT",a.SetAccountData="SET_ACCOUNT_DATA",a.LoadHistoricalIncentivesData="LOAD_HISTORICAL_INCENTIVES_DATA",a.SetHistoricalIncentivesData="SET_HISTORICAL_INCENTIVES_DATA"}(t||(t={}));var w,x,O,p,f,N,C,k,I=e(19),B=e.n(I),A={account:{loading:!1,data:{address:null,balance:"0",contributions:[]}},chronicle:{loading:!1,data:{curBlockNum:0,curAuctionId:0,curAuction:{closingStart:null,closingEnd:null,blockNum:null}}},own:{loading:!1,data:{crowdloan:null,aggregatedCrowdloanBalances:[]}},sibling:{loading:!1,data:{crowdloan:null,aggregatedCrowdloanBalances:[]}},historicalIncentives:{loading:!1,data:{}}},S=function(a,n){B.a.debug("Store","action",n.type,n.payload,a);var e=function(){switch(n.type){case t.LoadChronicle:return Object(m.a)(Object(m.a)({},a),{},{chronicle:Object(m.a)(Object(m.a)({},a.chronicle),{},{loading:!0})});case t.SetChronicle:return Object(m.a)(Object(m.a)({},a),{},{chronicle:Object(m.a)(Object(m.a)({},a.chronicle),{},{loading:!1,data:n.payload})});case t.LoadOwnData:return Object(m.a)(Object(m.a)({},a),{},{own:Object(m.a)(Object(m.a)({},a.own),{},{loading:!0})});case t.SetOwnData:return Object(m.a)(Object(m.a)({},a),{},{own:Object(m.a)(Object(m.a)({},a.own),{},{loading:!1,data:n.payload})});case t.LoadSiblingData:return Object(m.a)(Object(m.a)({},a),{},{sibling:Object(m.a)(Object(m.a)({},a.sibling),{},{loading:!0})});case t.SetSiblingData:return Object(m.a)(Object(m.a)({},a),{},{sibling:{loading:!1,data:n.payload}});case t.ConnectAccount:return Object(m.a)(Object(m.a)({},a),{},{account:Object(m.a)(Object(m.a)({},A.account),{},{loading:!0})});case t.SetAccountData:return Object(m.a)(Object(m.a)({},a),{},{account:Object(m.a)(Object(m.a)({},a.account),{},{loading:!1,data:n.payload})});case t.LoadHistoricalIncentivesData:return Object(m.a)(Object(m.a)({},a),{},{historicalIncentives:Object(m.a)(Object(m.a)({},a.historicalIncentives),{},{loading:!0})});case t.SetHistoricalIncentivesData:return Object(m.a)(Object(m.a)({},a),{},{historicalIncentives:Object(m.a)(Object(m.a)({},a.historicalIncentives),{},{loading:!1,data:n.payload})});default:return a}}();return B.a.debug("Store","newState",e),e},y=Object(v.a)((function(){var a=Object(c.useReducer)(S,A),n=Object(h.a)(a,2);return{state:n[0],dispatch:n[1]}})),D=Object(h.a)(y,2),E=D[0],R=D[1],P=function(){return R().state.chronicle},T=function(){return R().state.own},L=function(){return R().state.sibling},M=e(23),F=e.n(M),$=e(28),_=e(471),q=e(467),H=e(180),U=e(473),W={address:function(){var a=new URL(document.location).searchParams;return B.a.debug("account",a.get("account")),a.get("account")}()||"D5CVLHRhookKgoYLrszyuF4yxNPpHCFBAMZEzL7xUGtwkgG"},G=Object(v.a)((function(){var a=Object(c.useState)([]),n=Object(h.a)(a,2),e=n[0],t=n[1],i=Object(U.a)("bsx-crowdloan-account",W.address),o=Object(h.a)(i,2),r=o[0],l=o[1],d=Object(c.useState)("0"),s=Object(h.a)(d,2),b=s[0],g=s[1],j=Object(c.useState)(!1),m=Object(h.a)(j,2),v=(m[0],m[1],Object(c.useState)(!1)),w=Object(h.a)(v,2),x=(w[0],w[1]),O=Object(c.useState)(void 0),p=Object(h.a)(O,2),f=p[0],N=p[1],C=Object(c.useState)(void 0),k=Object(h.a)(C,2),I=k[0],A=k[1];return Object(c.useEffect)((function(){Object($.a)(F.a.mark((function a(){var n,e,c,i;return F.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return B.a.debug("usePolkadot","loading initial"),x(!0),a.next=4,Object(H.b)(u.dappName);case 4:return n=a.sent,a.next=7,Object(H.a)();case 7:return e=a.sent,c=new _.a(u.nodeUrl),a.next=11,q.a.create({provider:c});case 11:i=a.sent,B.a.debug("usePolkadot","loaded",n,i),console.log("allAccount",e),t(e),N(i),x(!1);case 17:case"end":return a.stop()}}),a)})))()}),[]),Object(c.useEffect)((function(){r&&f&&Object($.a)(F.a.mark((function a(){var n,e;return F.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.query.system.account(r);case 2:n=a.sent,e=n.data,B.a.debug("usePolkadot","balance",e.free.toString()),g(e.free.toString());case 6:case"end":return a.stop()}}),a)})))()}),[r,f]),{accounts:e,setActiveAccount:l,activeAccount:r,activeAccountBalance:b,lastContributionStatus:I,contribute:function(){var a=Object($.a)(F.a.mark((function a(n){var e;return F.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(f){a.next=2;break}return a.abrupt("return");case 2:if(r){a.next=4;break}return a.abrupt("return");case 4:return x(!0),console.log("running api contribute",n,f,r),a.next=8,Object(H.c)(r);case 8:e=a.sent,console.log("api crowdloan",f.tx.crowdloan.contribute),Object($.a)(F.a.mark((function a(){return F.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,f.tx.crowdloan.contribute(u.ownParaId,n,null).signAndSend(r,{signer:e.signer});case 3:a.sent,console.log("contribute",r,e.signer),A(!0),a.next=12;break;case 8:a.prev=8,a.t0=a.catch(0),A(!1),console.log("error sending contribution",a.t0);case 12:x(!1);case 13:case"end":return a.stop()}}),a,null,[[0,8]])})))();case 11:case"end":return a.stop()}}),a)})));return function(n){return a.apply(this,arguments)}}()}})),z=Object(h.a)(G,2),V=z[0],K=z[1],J=(e(321),e.p+"static/media/Logo-dark-2-clean.cbd38319.png"),X=e.p+"static/media/basilisk-wallpaper-2.cc01249c.png",Y=e(37),Z=e.n(Y),Q=e(90),aa=e.n(Q),na=u.incentives,ea=function(a,n,e,t){if(B.a.debug("calculateBsxMultiplier",n),a>=u.historicalAuctionData[u.targetAuctionId].closingEnd)return na.bsx.scale.rewardMultiplier.none;if((n||0)<u.targetAuctionId)return na.bsx.scale.rewardMultiplier.min;if(!e||!t)return na.bsx.scale.rewardMultiplier.min;var c=aa()([e,t],[na.bsx.scale.rewardMultiplier.min,na.bsx.scale.rewardMultiplier.max]);return a>=e?c(a):na.bsx.scale.rewardMultiplier.min},ta=u.incentives,ca=aa()([ta.hdx.scale.leadPercentageDiff.min,ta.hdx.scale.leadPercentageDiff.max],[ta.hdx.scale.rewardMultiplier.min,ta.hdx.scale.rewardMultiplier.max]),ia=e(83),oa=e(469),ra=e(472),la=u.ownCrowdloanBlockNum,da='\n    chronicle(id: "'.concat("ChronicleKey",'") {\n        curBlockNum\n        curAuctionId,\n        curAuction {\n            closingStart,\n            closingEnd\n        }\n    }\n'),sa=Object(oa.a)(w||(w=Object(ia.a)(["\n    query chronicle {\n        ","\n    }\n"])),da),ua=Object(oa.a)(x||(x=Object(ia.a)(["\n    query ownCrowdloan($parachainId: String) {\n        crowdloans(filter: {\n            parachainId: {\n                equalTo: $parachainId\n            }\n        }){\n            ","\n        }\n    }\n"])),"\n    nodes{\n        id,\n        cap,\n        raised,\n        parachainId,\n        blockNum\n    }\n"),ba=Object(oa.a)(O||(O=Object(ia.a)(["\n    query getAggregatedCrowdloanBalances($parachainId: String, $onlySignificant: Boolean, $ownCrowdloanBlockNum: Int) {\n        aggregatedCrowdloanBalances(\n            filter: { \n                parachainId: { equalTo: $parachainId },\n                isSignificant: { equalTo: $onlySignificant }\n                blockNum: {\n                    greaterThanOrEqualTo: $ownCrowdloanBlockNum\n                }\n            },\n            orderBy: BLOCK_NUM_ASC\n        ) {\n            nodes {\n                id,\n                blockNum,\n                raised,\n                parachainId\n            }\n        }\n    }\n"]))),ga=Object(oa.a)(p||(p=Object(ia.a)(["\n    query siblingCrowdloanCandidates($ownParachainId: String) {\n        crowdloans(\n            filter: { \n                parachainId: { notEqualTo: $ownParachainId }\n                isFinished: { notEqualTo: true }\n                # only crowdloans that have not won an auction yet\n                wonAuctionId: { isNull: true }\n            }\n            first: 2\n            orderBy: RAISED_DESC\n        ) {\n            nodes {\n                blockNum\n                id\n                raised\n                parachainId\n            }\n        }\n    }\n"]))),ja=(Object(oa.a)(f||(f=Object(ia.a)(["\n    query contributionsByAddressAndParachainId($account: String, $parachainId: String, $ownCrowdloanBlockNum: Int) {\n        contributions(\n            filter:{\n                account: {\n                    equalTo: $account\n                },\n                parachainId: {\n                    equalTo: $parachainId\n                },\n                blockNum: {\n                    greaterThan: $ownCrowdloanBlockNum\n                }\n            }\n        ){\n            nodes{\n                amount,\n                account,\n                parachainId,\n                blockNum\n            }\n        }\n    }\n"]))),Object(oa.a)(N||(N=Object(ia.a)(["\n    query historicalSiblingCrowdloanCandidates($ownParachainId: String, $blockNums: [Int!]) {\n        aggregatedCrowdloanBalances(\n            filter: { \n                parachainId: { notEqualTo: $ownParachainId }\n                blockNum: { in: $blockNums }\n            }\n            orderBy: RAISED_DESC\n        ) {\n            nodes {\n                blockNum\n                id\n                raised\n                parachainId,\n                fund {\n                    wonAuctionId\n                }\n            }\n        }\n    }\n"]))),Object(oa.a)(C||(C=Object(ia.a)(["\n    query historicalSiblingCrowdloanCandidates($ownParachainId: String, $blockNums: [Int!]) {\n        aggregatedCrowdloanBalances(\n            filter: { \n                parachainId: { equalTo: $ownParachainId }\n                # only crowdloans that have not won an auction yet\n                # wonAuctionId: { isNull: true }\n                blockNum: { in: $blockNums }\n            }\n        ) {\n            nodes {\n                blockNum\n                id\n                raised\n                parachainId,\n            }\n        }\n    }\n"]))),Object(oa.a)(k||(k=Object(ia.a)(["\n    query contributions($ownParachainId: String, $ownCrowdloanBlockNum: Int) {\n        contributions(filter:{\n            parachainId: {\n                equalTo: $ownParachainId\n            },\n            blockNum:{\n                greaterThan: $ownCrowdloanBlockNum\n            },\n        }) {\n            totalCount,\n            nodes{\n                blockNum,\n                amount\n            }\n        }\n    }\n"]))),function(a){return Object(ra.a)(ua,{variables:{parachainId:a}})}),ha=function(a){return Object(ra.a)(ba,{variables:Object(m.a)({onlySignificant:!0,ownCrowdloanBlockNum:la},a)})},ma=e(73),va=function(){var a=Object(ra.a)(sa),n=Object(h.a)(a,2),e=n[0],i=n[1],o=R(),r=o.state,l=o.dispatch;return Object(c.useEffect)((function(){B.a.debug("useChronicleData","state.chronicle.loading",r.chronicle.loading),r.chronicle.loading&&e()}),[r.chronicle.loading,e]),Object(c.useEffect)((function(){var a,n,e;i.called&&!i.loading&&(B.a.debug("useChronicleData","chronicle",i),i.data&&l({type:t.SetChronicle,payload:{curBlockNum:i.data.chronicle.curBlockNum,curAuctionId:i.data.chronicle.curAuctionId?parseInt(i.data.chronicle.curAuctionId):0,curAuction:{closingStart:null===(a=i.data.chronicle.curAuction)||void 0===a?void 0:a.closingStart,closingEnd:null===(n=i.data.chronicle.curAuction)||void 0===n?void 0:n.closingEnd,blockNum:null===(e=i.data.chronicle.curAuction)||void 0===e?void 0:e.blockNum}}}))}),[i,l]),{chronicle:r.chronicle}},wa=function(){var a=ja(u.ownParachainId),n=Object(h.a)(a,2),e=n[0],i=n[1],o=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ha(Object(m.a)({parachainId:u.ownParachainId},a))}(),r=Object(h.a)(o,2),l=r[0],d=r[1],s=R().dispatch,b=P(),g=T();Object(c.useEffect)((function(){B.a.debug("useOwnData","chronicle changed, loading own data",i.loading,d.loading),i.loading||d.loading||s({type:t.LoadOwnData})}),[b.data.curBlockNum,i.loading,d.loading,s]),Object(c.useEffect)((function(){B.a.debug("useOwnData","state.own.loading",g.loading),g.loading&&(B.a.debug("useOwnData","getOwnCrowdloan"),e(),B.a.debug("useOwnData","getOwnCrowgetOwnAggregatedCrowdloanBalancesdloan"),l())}),[g.loading,e,l]);var j=Object(ma.every)([i.loading,d.loading,!d.called]);return B.a.debug("useOwnData","loading",j),Object(c.useEffect)((function(){var a;if(i.called&&!i.loading&&d.called&&!d.loading&&(B.a.debug("useOwnData","ownCrowdloan",i),B.a.debug("useOwnData","ownCrowdloanAggregatedBalances",d),i.data)){var n=i.data.crowdloans.nodes[0];n={id:n.id,parachainId:n.parachainId,raised:n.raised,cap:n.cap,blockNum:n.blockNum};var e=null===(a=d.data)||void 0===a?void 0:a.aggregatedCrowdloanBalances.nodes.map((function(a){return{id:a.id,blockNum:a.blockNum,raised:a.raised,parachainId:a.parachainId}}));B.a.debug("useOwnData","crowdloan",n),B.a.debug("useOwndata","aggregatedCrowdloanBalances",e),s({type:t.LoadSiblingData}),s({type:t.SetOwnData,payload:{crowdloan:n,aggregatedCrowdloanBalances:e}})}}),[i,d,j,s]),{own:g,ownLoading:j}},xa=function(a,n){B.a.debug("determineSiblingParachain",a,n);var e=a.map((function(a){return{valuation:a.raised,parachainId:a.parachainId}}))||[],t=(n||0)<u.targetAuctionId?e[1]:e[0];return B.a.debug("determineSiblingParachain","siblingParachain",null===t||void 0===t?void 0:t.parachainId),null===t||void 0===t?void 0:t.parachainId},Oa=function(){var a,n=P(),e=T(),i=R().dispatch,o=L(),r=Object(ra.a)(ga,{variables:{ownParachainId:u.ownParachainId}}),l=Object(h.a)(r,2),d=l[0],s=l[1],b=Object(c.useState)(""),g=Object(h.a)(b,2),j=g[0],m=g[1],v=ja(j),w=Object(h.a)(v,2),x=w[0],O=w[1],p=ha({parachainId:j}),f=Object(h.a)(p,2),N=f[0],C=f[1],k=Object(ma.every)([O.loading,!O.called,C.loading,!C.called]);return Object(c.useEffect)((function(){n.data.curBlockNum&&o.loading&&(O.loading||s.loading||(B.a.debug("useSiblingData","getSiblingCrowdloanCandidates"),d()))}),[n.data.curBlockNum,o.loading,d]),Object(c.useEffect)((function(){var a,t;if(!e.loading&&e.data.crowdloan&&n.data.curBlockNum&&s.called&&!s.loading){B.a.debug("useSiblingData","loaded","determining sibling parachain");var c=xa(null===(a=s.data)||void 0===a?void 0:a.crowdloans.nodes,null===(t=n.data)||void 0===t?void 0:t.curAuctionId);m(c)}}),[s,null===(a=n.data)||void 0===a?void 0:a.curAuctionId,e.data.crowdloan,e.loading]),Object(c.useEffect)((function(){j&&n.data.curBlockNum&&o.loading&&(B.a.debug("useSiblingData","fetching sibling data"),N(),x())}),[j,n.data.curBlockNum,o.loading]),Object(c.useEffect)((function(){var a;if(O.called&&!O.loading&&C.called&&!C.loading){B.a.debug("useSiblingData","fetched sibling data","parsing");var n=O.data.crowdloans.nodes[0];n={id:n.id,parachainId:n.parachainId,raised:n.raised,cap:n.cap,blockNum:n.blockNum};var e=null===(a=C.data)||void 0===a?void 0:a.aggregatedCrowdloanBalances.nodes.map((function(a){return{id:a.id,blockNum:a.blockNum,raised:a.raised,parachainId:a.parachainId}}));B.a.debug("useSiblingData","setting sibling data"),i({type:t.SetSiblingData,payload:{crowdloan:n,aggregatedCrowdloanBalances:e}})}}),[C,O]),{sibling:o,siblingLoading:k}},pa=function(a,n,e,t,c,i){B.a.debug("calculateIncentives",{blockNum:a,curAuctionId:n,curAuctionClosingStart:e,curAuctionClosingEnd:t,ownCrowdloanValuation:c,siblingCrowdloanValuation:i});var o=u.historicalAuctionData[u.targetAuctionId].closingEnd,r={hdxBonus:"0",bsxMultiplier:"0"};if(void 0==c)return B.a.debug("calculateIncentives","no ownCrowdloanValuation"),r;if(a>(o||0))return B.a.debug("calculateIncentives","contribution newer than target auction end"),r;var l=ea(a,n,e,t);B.a.debug("calculateIncentives","calculateBsxMultiplier",l);var d=!!e&&a>=e;B.a.debug("calculateIncentives","isAuctionClosing",d);var s=function(a,n,e){if(n.isLessThanOrEqualTo(a))return ta.hdx.scale.rewardMultiplier.min;var t=a.minus(n).dividedBy(n).multipliedBy(-1);B.a.debug("calculateHdxMultiplier","leadPercentageDiff",n.toFixed(0),a.toFixed(0),t.toFixed(u.incentives.precision));var c=t.isGreaterThanOrEqualTo(ta.hdx.scale.leadPercentageDiff.max)?ta.hdx.scale.rewardMultiplier.max:ca(t);return B.a.debug("calculateHdxMultiplier","hdxBonus",c),c}(new Z.a(i||0),new Z.a(c||0));B.a.debug("calculateIncentives","hdxBonus",s);var b={hdxBonus:new Z.a(s).toFixed(u.ksmPrecision),bsxMultiplier:new Z.a(l).toFixed(u.ksmPrecision)};return B.a.debug("calculateIncentives","incentives",b),b},fa=function(a,n){return a.reduce((function(a,e){B.a.debug("useCalculateRewardsReceived","hdxReward","contribution",e,n.data[e.blockNum]);var t=new Z.a(e.amount).multipliedBy(u.ksmOpportunityCost);B.a.debug("useCalculateRewardsReceived","hdxReward","ksmOpportunityCostPerContribution",t);var c=t.multipliedBy(n.data[e.blockNum].hdxBonus);return B.a.debug("useCalculateRewardsReceived","hdxReward","contributionHdxReward",c),new Z.a(a).plus(c).toFixed(u.incentives.precision)}),"0")},Na=function(a,n,e,t,c){var i=a.reduce((function(a,e){var t=ea(e.blockNum,n.data.curAuctionId,n.data.curAuction.closingStart,n.data.curAuction.closingEnd);return B.a.debug("useCalculateRewardsReceived","accountWeight bsxMultiplier",t,{blockNum:e.blockNum,curAuctionId:n.data.curAuctionId,closingStart:n.data.curAuction.closingStart,closingEnd:n.data.curAuction.closingEnd}),new Z.a(a).plus(new Z.a(e.amount).multipliedBy(t)).toFixed(u.incentives.precision)}),"0");B.a.debug("useCalculateRewardsReceived","accountWeight",i),B.a.debug("useCalculateRewardsReceived","totalContributionWeight",e);var o=function(a,n,e){var t=n.reduce((function(a,n){var t=ea(n.blockNum,e.data.curAuctionId,e.data.curAuction.closingStart,e.data.curAuction.closingEnd);return B.a.debug("useCalculateRewardsReceived","accountWeight bsxMultiplier",t,{blockNum:n.blockNum,curAuctionId:e.data.curAuctionId,closingStart:e.data.curAuction.closingStart,closingEnd:e.data.curAuction.closingEnd}),new Z.a(a).plus(new Z.a(n.amount).multipliedBy(t)).toFixed(u.incentives.precision)}),"0");return new Z.a(u.incentives.bsx.allocated).dividedBy(a).multipliedBy(t).toFixed(u.incentives.precision)}(e,a,n);B.a.debug("useCalculateRewardsReceived","accountCurrentBsxReward",o);var r=function(a,n,e){var t=n.reduce((function(a,n){var t=ea(n.blockNum,e.data.curAuctionId,e.data.curAuction.closingStart,e.data.curAuction.closingEnd);return B.a.debug("useCalculateRewardsReceived","accountWeight bsxMultiplier",t,{blockNum:n.blockNum,curAuctionId:e.data.curAuctionId,closingStart:e.data.curAuction.closingStart,closingEnd:e.data.curAuction.closingEnd}),new Z.a(a).plus(new Z.a(n.amount).multipliedBy(t)).toFixed(u.incentives.precision)}),"0");return new Z.a(u.incentives.bsx.allocated).dividedBy(new Z.a(a).multipliedBy(u.incentives.bsx.scale.rewardMultiplier.min)).multipliedBy(t).toFixed(u.incentives.precision)}(t.data.crowdloan.cap,a,n);return B.a.debug("useCalculateRewardsReceived","accountMinimumBsxReward",r),{accountCurrentBsxReward:o,accountMinimumBsxReward:r}},Ca=function(a){return new Z.a(a).multipliedBy(new Z.a(10).exponentiatedBy(12)).toFixed(u.ksmPrecision)},ka=function(a){return new Z.a(a).dividedBy(new Z.a(10).exponentiatedBy(12)).toFixed(u.ksmPrecision)},Ia=function(a){return new Z.a(a).multipliedBy(u.ksmToUsd).toFixed(u.ksmPrecision)},Ba=function(a){return new Z.a(a).dividedBy(u.hdxToUsd).toFixed(u.ksmPrecision)},Aa=e(258),Sa=e.n(Aa),ya=(e(322),function(a){var n=a.totalContributionWeight,e=K().contribute,t=T(),i=P(),o=function(){var a,n,e,t,c=P(),i=T(),o=L(),r=pa(c.data.curBlockNum,c.data.curAuctionId,null===(a=c.data.curAuction)||void 0===a?void 0:a.closingStart,null===(n=c.data.curAuction)||void 0===n?void 0:n.closingEnd,(null===(e=i.data.crowdloan)||void 0===e?void 0:e.raised)||void 0,(null===(t=o.data.crowdloan)||void 0===t?void 0:t.raised)||void 0);return i.data.crowdloan?r:{hdxBonus:null,bsxMultiplier:null}}(),r=K(),l=r.activeAccountBalance,d=r.lastContributionStatus,s=Object(c.useState)(0),u=Object(h.a)(s,2),g=u[0],j=u[1],m=Object(c.useState)({minimalBsxReceived:"0",currentBsxReward:"0",currentHdxReceived:"0"}),v=Object(h.a)(m,2),w=v[0],x=v[1];Object(c.useEffect)((function(){if(console.log("amount updated"),B.a.debug("CrowdloanContributeForm","calculating rewards",g,t,n),t&&i&&n&&t.data.crowdloan&&i.data.curBlockNum){var a=[{amount:g?Ca(g):"0",blockNum:i.data.curBlockNum}];console.log("input contributions",a);var e={data:{}};e.data[i.data.curBlockNum]={hdxBonus:o.hdxBonus},console.log("input incentives",e);var c=Na(a,i,n,t);B.a.debug("CrowdloanContributeForm","historicalIncentives",e);var r=fa(a,e);B.a.debug("CrowdloanContributeForm",c,r),x({minimalBsxReceived:ka(c.accountMinimumBsxReward),currentBsxReward:ka(c.accountCurrentBsxReward),currentHdxReceived:ka(r)})}}),[g,t,i,n]);Object(c.useEffect)((function(){console.log("lastContributionStatusChanged",d),d&&j(0)}),[d]);B.a.debug("CrowdloanContributeForm","rewardsReceived",w);var O=function(){};return Object(b.jsxs)("div",{className:"bsx-contribute-form",children:[Object(b.jsxs)("div",{className:"bsx-form-wrapper",children:[Object(b.jsx)("label",{children:"ksm contribution"}),Object(b.jsx)(Sa.a,{name:"amount",decimalsLimit:12,value:g,onValueChange:function(a){if(B.a.debug("CrowdloanContributeForm","handleContributeChange",a,l),console.log("handleContributeChange",a),void 0==a)return j(void 0);j(a)}}),Object(b.jsx)("label",{children:"minimal bsx received"}),Object(b.jsx)("input",{name:"amount",type:"string",value:w.minimalBsxReceived,onChange:O}),Object(b.jsx)("label",{children:"current bsx received"}),Object(b.jsx)("input",{name:"amount",type:"string",value:w.currentBsxReward,onChange:O}),Object(b.jsx)("label",{children:"current hdx received"}),Object(b.jsx)("input",{name:"amount",type:"string",value:Ba(Ia(w.currentHdxReceived)),onChange:O}),Object(b.jsx)("button",{disabled:!g||0==g,onClick:function(){B.a.debug("CrowdloanContributeForm","handleContributeClick",g),e(Ca(g))},children:"Contribute"})]}),Object(b.jsx)("div",{className:"contribution-status",children:"There was a problem with your contribution, please try again."})]})}),Da=e(206),Ea=e(205),Ra=e.n(Ea),Pa=e(43),Ta=e(262);Pa.b.register(Ta.a),Da.b.animation=!1;var La="#ffe733",Ma="#90ff33",Fa="#171b22",$a="#ebebeb",_a="rgba(181, 149, 114, .1)",qa="transparent",Ha=function(){var a=R().dispatch,n=va().chronicle,e=wa(),i=e.own,o=(e.ownLoading,Oa()),r=o.sibling;o.siblingLoading;Object(c.useEffect)((function(){return a({type:t.LoadChronicle})}),[]);var l=Object(c.useMemo)((function(){return!i.data.crowdloan||!r.data.crowdloan||n.loading}),[i.data,r.data]);return{chronicle:n,own:i,sibling:r,isDashboardEssentialDataLoading:l}},Ua=function(){var a,n,e=Ha(),t=e.chronicle,i=e.own,o=e.sibling,r=e.isDashboardEssentialDataLoading,l=u.targetAuctionId,d=u.historicalAuctionData[l],s=Object(ma.range)(u.ownCrowdloanBlockNum,d.closingEnd,1),g=(aa()([u.ownCrowdloanBlockNum,l],[s[0],s[s.length-1]]),Object(c.useMemo)((function(){var a,n,e,t,c={labels:s,datasets:[]};return i.loading||o.loading?c:{labels:s,datasets:[{label:"Basilisk",borderColor:Ma,yAxisID:"crowdloanCap",data:null===(a=i.data.aggregatedCrowdloanBalances)||void 0===a?void 0:a.map((function(a){return ka("".concat(a.raised))})).concat(i.data.crowdloan?[ka("".concat(null===(n=i.data.crowdloan)||void 0===n?void 0:n.raised))]:[])},{label:"Sibling",borderColor:La,yAxisID:"crowdloanCap",data:null===(e=o.data.aggregatedCrowdloanBalances)||void 0===e?void 0:e.map((function(a){return ka("".concat(a.raised))})).concat(o.data.crowdloan?[ka("".concat(null===(t=o.data.crowdloan)||void 0===t?void 0:t.raised))]:[])},{label:"BSX Multiplier",yAxisID:"bsxMultiplier",borderColor:qa,backgroundColor:_a,fill:!0,data:s.map((function(a){return ea(a,l,d.closingStart,d.closingEnd)}))}]}}),[i.data,i.loading,o.data,o.loading])),j={backgroundColor:Ma,position:"end",enabled:!0,color:Fa,font:{family:"Pexico-Regular",size:12},xAdjust:10,cornerRadius:0},h=Object(c.useMemo)((function(){var a,n;return{pointRadius:0,responsive:!0,maintainAspectRatio:!1,scales:{x:{display:!1},crowdloanCap:{type:"linear",position:"left",display:!1,max:2e5,min:0},bsxMultiplier:{type:"linear",display:!1,position:"right",max:1.3,min:0}},plugins:{legend:{display:!1},autocolors:!1,annotation:{annotations:{now:t.data.curBlockNum?{type:"line",xMin:t.data.curBlockNum,xMax:t.data.curBlockNum,borderColor:$a,borderWidth:3,borderDash:[3,3],scaleID:"x"}:null,ownRaised:(null===(a=i.data.crowdloan)||void 0===a?void 0:a.raised)?{type:"line",value:ka(i.data.crowdloan.raised),borderColor:Ma,borderWidth:1,borderDash:[3,3],scaleID:"crowdloanCap",label:Object(m.a)(Object(m.a)({},j),{},{content:Ra()(parseFloat(ka(i.data.crowdloan.raised)))})}:null,siblingRaised:(null===(n=o.data.crowdloan)||void 0===n?void 0:n.raised)?{type:"line",borderWidth:1,borderDash:[3,3],scaleID:"crowdloanCap",value:ka(o.data.crowdloan.raised),borderColor:La,label:Object(m.a)(Object(m.a)({},j),{},{backgroundColor:La,content:Ra()(parseFloat(ka(o.data.crowdloan.raised)))})}:null}}}}}),[null===(a=i.data.crowdloan)||void 0===a?void 0:a.raised,null===(n=o.data.crowdloan)||void 0===n?void 0:n.raised,t.data.curBlockNum]),v=Object(c.useMemo)((function(){return r}),[r]);return console.log(t.data.curBlockNum),Object(b.jsxs)("div",{className:"bsx-dashboard",children:[Object(b.jsx)("div",{className:"bsx-navbar",children:Object(b.jsx)("div",{className:"container",children:Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-3",children:Object(b.jsx)("div",{className:"bsx-logo",children:"basilisk"})}),Object(b.jsx)("div",{className:"col-9 bsx-menu-col",children:Object(b.jsxs)("div",{className:"bsx-menu",children:[Object(b.jsx)("div",{className:"bsx-menu-item",children:Object(b.jsx)("a",{href:"https://bsx.fi/",target:"_blank",children:"home"})}),Object(b.jsx)("div",{className:"bsx-menu-item",children:Object(b.jsx)("a",{href:"https://discord.gg/S8YZj5aXR6",target:"_blank",children:"discord"})}),Object(b.jsx)("div",{className:"bsx-eye",children:Object(b.jsx)("img",{src:J})}),Object(b.jsx)("div",{className:"bsx-menu-item",children:Object(b.jsx)("a",{href:"https://github.com/galacticcouncil/Basilisk-node",target:"_blank",children:"github"})}),Object(b.jsx)("div",{className:"bsx-menu-item",children:Object(b.jsx)("a",{href:"https://basiliskfi.substack.com/p/basilisk-parachain-crowdloan",target:"_blank",children:"faq"})}),Object(b.jsx)("div",{className:"bsx-menu-item",children:Object(b.jsx)("a",{href:"https://basiliskfi.substack.com/",target:"_blank",children:"blog"})})]})})]})})}),Object(b.jsx)("div",{className:"bsx-account",children:Object(b.jsxs)("div",{className:"container",children:[Object(b.jsxs)("div",{className:"row bsx-account-selector-display",children:[Object(b.jsx)("div",{className:"col-9 bsx-address",children:"Em9CzTD4q3zAD5gjAKS5bzUYCDq2jhLXcM66PvJvaFbmTN8"}),Object(b.jsx)("div",{className:"col-3 bsx-select-account",children:"change your account"})]}),Object(b.jsxs)("div",{className:"row bsx-stats",children:[Object(b.jsx)("div",{className:"col-9",children:Object(b.jsxs)("div",{className:"row",children:[Object(b.jsxs)("div",{className:"col-3 bsx-stat",children:[Object(b.jsx)("span",{className:"bsx-stat-title",children:"total ksm contributed"}),Object(b.jsx)("span",{className:"bsx-stat-value",children:"50 000"})]}),Object(b.jsxs)("div",{className:"col-3 bsx-stat",children:[Object(b.jsx)("span",{className:"bsx-stat-title",children:"minimal bsx received"}),Object(b.jsx)("span",{className:"bsx-stat-value",children:"50 000"})]}),Object(b.jsxs)("div",{className:"col-3 bsx-stat",children:[Object(b.jsx)("span",{className:"bsx-stat-title",children:"current bsx received"}),Object(b.jsx)("span",{className:"bsx-stat-value",children:"50 000"})]}),Object(b.jsxs)("div",{className:"col-3 bsx-stat",children:[Object(b.jsx)("span",{className:"bsx-stat-title",children:"current hdx reward"}),Object(b.jsx)("span",{className:"bsx-stat-value",children:"50 000"})]})]})}),Object(b.jsxs)("div",{className:"col-3 bsx-stat bsx-stat-balance",children:[Object(b.jsx)("span",{className:"bsx-stat-title",children:"balance"}),Object(b.jsx)("span",{className:"bsx-stat-value",children:"50 000"})]})]})]})}),Object(b.jsx)("div",{className:"container",children:Object(b.jsxs)("div",{className:"row",children:[Object(b.jsxs)("div",{className:"col-9 bsx-graph",children:[Object(b.jsx)("div",{className:"bsx-graph-wrapper",children:v?Object(b.jsx)("div",{className:"bsx-graph-loader",children:"Fetching graph data..."}):Object(b.jsx)(Da.a,{id:"1",type:"line",data:g,options:h})}),Object(b.jsx)("div",{className:"bsx-graph-timeline",children:"test"})]}),Object(b.jsxs)("div",{className:"col-3 bsx-contribute",children:[Object(b.jsx)("div",{className:"bsx-incentives",children:r?Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{className:"bsx-incentives-loader",children:"Caluculating incentives..."})}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"bsx-incentive",children:Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-6 name",children:Object(b.jsx)("span",{children:"hdx bonus"})}),Object(b.jsx)("div",{className:"col-6 value",children:Object(b.jsx)("span",{children:"~17.5%"})})]})}),Object(b.jsx)("div",{className:"bsx-incentive",children:Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-9 name",children:Object(b.jsx)("span",{children:"bsx multiplier"})}),Object(b.jsx)("div",{className:"col-3 value",children:Object(b.jsx)("span",{children:"~1"})})]})})]})}),Object(b.jsx)("div",{children:Object(b.jsx)(ya,{totalContributionWeight:""})})]})]})}),Object(b.jsx)("div",{className:"bsx-wallpaper",children:Object(b.jsx)("img",{src:X})})]})};var Wa=function(){return Object(b.jsx)(j,{children:Object(b.jsx)(E,{children:Object(b.jsx)(V,{children:Object(b.jsx)(Ua,{})})})})},Ga=function(a){a&&a instanceof Function&&e.e(3).then(e.bind(null,477)).then((function(n){var e=n.getCLS,t=n.getFID,c=n.getFCP,i=n.getLCP,o=n.getTTFB;e(a),t(a),c(a),i(a),o(a)}))},za=aa()([10,20],[10,0],!0);console.log("scaleFunction",za(11));var Va=new URL(document.location).searchParams.get("loglevel")||"info";B.a.setLevel(Va),r.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(Wa,{})}),document.getElementById("root")),Ga()}},[[435,1,2]]]);
//# sourceMappingURL=main.1198cbd8.chunk.js.map